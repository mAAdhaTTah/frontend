<div id="__next"><div class="flex flex-row"><div class="print:hidden h-screen w-0 xl:w-88" style="width: 352px;"><header class="flex flex-col print:hidden fixed h-screen overflow-hidden w-inherit"><div class="h-screen overflow-hidden relative"><span style="box-sizing:border-box;display:block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:absolute;top:0;left:0;bottom:0;right:0"><img alt="background image" sizes="100vw" srcset="/_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=640&amp;q=75 640w, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=750&amp;q=75 750w, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=828&amp;q=75 828w, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=1080&amp;q=75 1080w, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=1200&amp;q=75 1200w, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=1920&amp;q=75 1920w, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=2048&amp;q=75 2048w, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=3840&amp;q=75 3840w" src="/_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;object-fit:cover;object-position:center center"><noscript><img alt="background image" sizes="100vw" srcSet="/_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=640&amp;q=75 640w, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=750&amp;q=75 750w, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=828&amp;q=75 828w, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=1080&amp;q=75 1080w, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=1200&amp;q=75 1200w, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=1920&amp;q=75 1920w, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=2048&amp;q=75 2048w, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=3840&amp;q=75 3840w" src="/_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2020%2F11%2Fheader-1.jpg&amp;w=3840&amp;q=75" decoding="async" data-nimg="fill" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%;object-fit:cover;object-position:center center" loading="lazy"/></noscript></span></div><div class="absolute bg-etched rounded-lg text-center inline-flex lg:flex flex-row items-center justify-center lg:justify-start w-full max-w-xs sm:max-w-sm lg:max-w-md pin-center -mt-8 m-auto w-full"><div class="flex flex-row items-center justify-center w-full p-2"><div class="w-0 lg:w-48 h-48 rounded-full overflow-hidden flex-grow-0 transition-width ease-in-out lg:w-0"><span style="box-sizing:border-box;display:inline-block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;position:relative;max-width:100%"><span style="box-sizing:border-box;display:block;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0;max-width:100%"><img style="display:block;max-width:100%;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0" alt="" aria-hidden="true" src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYwIiBoZWlnaHQ9IjM2MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2ZXJzaW9uPSIxLjEiLz4="></span><img alt="avatar" srcset="/_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2015%2F02%2Fnew-avatar-sq.jpg&amp;w=384&amp;q=75 1x, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2015%2F02%2Fnew-avatar-sq.jpg&amp;w=750&amp;q=75 2x" src="/_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2015%2F02%2Fnew-avatar-sq.jpg&amp;w=750&amp;q=75" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"><noscript><img alt="avatar" srcSet="/_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2015%2F02%2Fnew-avatar-sq.jpg&amp;w=384&amp;q=75 1x, /_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2015%2F02%2Fnew-avatar-sq.jpg&amp;w=750&amp;q=75 2x" src="/_next/image/?url=https%3A%2F%2Fstatic.jamesdigioia.com%2Fuploads%2F2015%2F02%2Fnew-avatar-sq.jpg&amp;w=750&amp;q=75" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" loading="lazy"/></noscript></span></div><div class="font-muli lg:ml-5 flex-grow"><div class="text-4xl lg:text-5xl font-bold font-muli mb-3" data-typeit-id="0320960">James DiGioia<span class="ti-cursor" style="visibility: hidden;"></span></div><div class="text-xl md:text-3xl mb-3 flex flex-row align-center justify-center text-center"><a class="border-2 border-transparent focus:border-primary focus:outline-none" href="https://www.facebook.com/james.digioia" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="text-4xl" style="color:#3b5998" alt="Facebook" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"></path></svg></a><a class="border-2 border-transparent focus:border-primary focus:outline-none" href="https://www.linkedin.com/in/jamesdigioia" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="text-4xl" style="color:#4875b4" alt="LinkedIn" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a><a class="border-2 border-transparent focus:border-primary focus:outline-none" href="https://github.com/mAAdhaTTah/" target="_blank" rel="noopener noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="text-4xl" style="color:#333" alt="GitHub" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M400 32H48C21.5 32 0 53.5 0 80v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48zM277.3 415.7c-8.4 1.5-11.5-3.7-11.5-8 0-5.4.2-33 .2-55.3 0-15.6-5.2-25.5-11.3-30.7 37-4.1 76-9.2 76-73.1 0-18.2-6.5-27.3-17.1-39 1.7-4.3 7.4-22-1.7-45-13.9-4.3-45.7 17.9-45.7 17.9-13.2-3.7-27.5-5.6-41.6-5.6-14.1 0-28.4 1.9-41.6 5.6 0 0-31.8-22.2-45.7-17.9-9.1 22.9-3.5 40.6-1.7 45-10.6 11.7-15.6 20.8-15.6 39 0 63.6 37.3 69 74.3 73.1-4.8 4.3-9.1 11.7-10.6 22.3-9.5 4.3-33.8 11.7-48.3-13.9-9.1-15.8-25.5-17.1-25.5-17.1-16.2-.2-1.1 10.2-1.1 10.2 10.8 5 18.4 24.2 18.4 24.2 9.7 29.7 56.1 19.7 56.1 19.7 0 13.9.2 36.5.2 40.6 0 4.3-3 9.5-11.5 8-66-22.1-112.2-84.9-112.2-158.3 0-91.8 70.2-161.5 162-161.5S388 165.6 388 257.4c.1 73.4-44.7 136.3-110.7 158.3zm-98.1-61.1c-1.9.4-3.7-.4-3.9-1.7-.2-1.5 1.1-2.8 3-3.2 1.9-.2 3.7.6 3.9 1.9.3 1.3-1 2.6-3 3zm-9.5-.9c0 1.3-1.5 2.4-3.5 2.4-2.2.2-3.7-.9-3.7-2.4 0-1.3 1.5-2.4 3.5-2.4 1.9-.2 3.7.9 3.7 2.4zm-13.7-1.1c-.4 1.3-2.4 1.9-4.1 1.3-1.9-.4-3.2-1.9-2.8-3.2.4-1.3 2.4-1.9 4.1-1.5 2 .6 3.3 2.1 2.8 3.4zm-12.3-5.4c-.9 1.1-2.8.9-4.3-.6-1.5-1.3-1.9-3.2-.9-4.1.9-1.1 2.8-.9 4.3.6 1.3 1.3 1.8 3.3.9 4.1zm-9.1-9.1c-.9.6-2.6 0-3.7-1.5s-1.1-3.2 0-3.9c1.1-.9 2.8-.2 3.7 1.3 1.1 1.5 1.1 3.3 0 4.1zm-6.5-9.7c-.9.9-2.4.4-3.5-.6-1.1-1.3-1.3-2.8-.4-3.5.9-.9 2.4-.4 3.5.6 1.1 1.3 1.3 2.8.4 3.5zm-6.7-7.4c-.4.9-1.7 1.1-2.8.4-1.3-.6-1.9-1.7-1.5-2.6.4-.6 1.5-.9 2.8-.4 1.3.7 1.9 1.8 1.5 2.6z"></path></svg></a></div><div class="relative text-xl lg:text-3xl" data-typeit-id="9335932">my little web home<span class="ti-cursor" style="visibility: hidden;"></span></div></div></div></div></header><div class="fixed top-2 left-2 z-50"><button class="rounded-full bg-darkg text-secondary p-1 border-2 border-darkg focus:outline-none focus:border-lightg"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="text-lg" alt="" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M16 132h416c8.837 0 16-7.163 16-16V76c0-8.837-7.163-16-16-16H16C7.163 60 0 67.163 0 76v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16zm0 160h416c8.837 0 16-7.163 16-16v-40c0-8.837-7.163-16-16-16H16c-8.837 0-16 7.163-16 16v40c0 8.837 7.163 16 16 16z"></path></svg><div style="border:0;clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;margin:0 -1px -1px 0;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap">Open menu</div></button></div></div><div class="relative flex-grow"><div style="opacity:1" class="absolute w-full"><article class="p-5 flow-root rounded pb-3 mb-5 max-w-xl mx-auto bg-primary"><header class="relative mb-5"><img src="https://static.jamesdigioia.com/uploads/2014/08/screenshot-1.png" alt="" class=""><div class="absolute pin-x-center pin-y-bottom w-full bg-etched rounded p-5"><div class="text-center"><h1 class="text-4xl text-lightg font-muli mb-5">How to add a button with a pop-up in WordPress’s TinyMCE editor</h1></div><div class="flex justify-center"><div class="flex-grow-0 entry-meta my-2 flex items-center rounded bg-secondary p-3 mb-3"><time class="font-body published" datetime="2014-08-04T14:20:36">August 4th, 2014</time><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="mx-3 w-1" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256 8C119 8 8 119 8 256s111 248 248 248 248-111 248-248S393 8 256 8z"></path></svg><p class="font-body">James DiGioia</p></div></div></div></header><section class="max-w-prose"><p class="font-ovo text-xl leading-normal pb-3">The main new feature in version 0.2.0 of WP-Gistpen was the integration of the Gistpen button into WordPress’s TinyMCE editor. Since TinyMCE was upgraded to version 4 in WordPress 3.9, many of the current tutorials are no longer entirely accurate. Additionally, TinyMCE’s documentation is shit, so I just want to share how I integrated a button that triggers a pop-up into TinyMCE 4.</p>
<p class="font-ovo text-xl leading-normal pb-3">First all, you can find&nbsp;the Gistpen-specific code on Github. All the PHP stuff is <a class="no-underline border-b-2 border-darkg" href="https://github.com/mAAdhaTTah/WP-Gistpen/blob/master/admin/class-wp-gistpen-admin.php">here</a>, and the JavaScript is <a class="no-underline border-b-2 border-darkg" href="https://github.com/mAAdhaTTah/WP-Gistpen/blob/master/admin/assets/js/tinymce-plugin.js">here</a>, if you want to see the specific implementation.</p>
<p class="font-ovo text-xl leading-normal pb-3">First, register the plugins and the buttons in WordPress on the proper filters:</p>
<div data-brk-container="repo"><div class="mb-5"><div class="code-toolbar"><pre class="line-numbers language-php" data-filename="register-tiny-mce-plugin.php"><code class="language-php"><span class="token function">add_filter</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token string single-quoted-string">'mce_external_plugins'</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token string single-quoted-string">'plugin_slug_add_button'</span><span class="token space"> </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token keyword">function</span><span class="token space"> </span><span class="token function">plugin_slug_add_button</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token variable">$plugins</span><span class="token space"> </span><span class="token punctuation">)</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token tab">	</span><span class="token variable">$plugins</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'plugin_slug'</span><span class="token punctuation">]</span><span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token string single-quoted-string">'path/to/editor/plugin.js'</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token tab">	</span><span class="token keyword">return</span><span class="token space"> </span><span class="token variable">$plugins</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token punctuation">}</span><span class="token lf">
</span><span class="token lf">
</span><span class="token function">add_filter</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token string single-quoted-string">'mce_buttons'</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token string single-quoted-string">'plugin_slug_register_button'</span><span class="token space"> </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token keyword">function</span><span class="token space"> </span><span class="token function">plugin_slug_register_button</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token variable">$buttons</span><span class="token space"> </span><span class="token punctuation">)</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token tab">	</span><span class="token function">array_push</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token variable">$buttons</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token string single-quoted-string">'plugin_slug'</span><span class="token space"> </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token tab">	</span><span class="token keyword">return</span><span class="token space"> </span><span class="token variable">$buttons</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button type="button">Copy</button></div><div class="toolbar-item"><span>register-tiny-mce-plugin.php</span></div></div></div></div></div>
<p class="font-ovo text-xl leading-normal pb-3">The <a class="no-underline border-b-2 border-darkg" href="/add-button-pop-wordpresss-tinymce-editor/#gistpen-register-tinymce-plugin-button.1"><code class="whitespace-nowrap">mce_external_plugin</code></a> filter registers the plugin, and the <a class="no-underline border-b-2 border-darkg" href="/add-button-pop-wordpresss-tinymce-editor/#gistpen-register-tinymce-plugin-button.7"><code class="whitespace-nowrap">mce_buttons</code></a> filter registers the button. Just swap out your plugin slugs and the path to the JavaScript file where you’re writing your TinyMCE plugin.</p>
<p class="font-ovo text-xl leading-normal pb-3">Here’s the TinyMCE plugin code itself. Take a quick look over the whole thing, as it’s a bit complicated, but we’ll go through all of the parts step-by-step:</p>
<div data-brk-container="repo"><div class="mb-5"><div class="code-toolbar"><pre class="line-numbers language-javascript" data-filename="tinyce-plugin.php"><code class="language-javascript"><span class="token punctuation">(</span><span class="token space"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token lf">
</span><span class="token tab">	</span><span class="token comment">//<span class="token space"> </span>Register<span class="token space"> </span>plugin</span><span class="token lf">
</span><span class="token tab">	</span>tinymce<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token string">'tinymce.plugins.plugin_slug'</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token function-variable function">init</span><span class="token operator">:</span><span class="token space"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token parameter">editor<span class="token punctuation">,</span><span class="token space"> </span>url</span><span class="token space"> </span><span class="token punctuation">)</span><span class="token space"> </span><span class="token space"> </span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token comment">//<span class="token space"> </span>Add<span class="token space"> </span>the<span class="token space"> </span>Insert<span class="token space"> </span>Gistpen<span class="token space"> </span>button</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>editor<span class="token punctuation">.</span><span class="token function">addButton</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token string">'plugin_slug'</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token comment">//text:<span class="token space"> </span>'Insert<span class="token space"> </span>Shortcode',</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>icon<span class="token operator">:</span><span class="token space"> </span><span class="token string">'icons<span class="token space"> </span>dashicons-icon'</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>tooltip<span class="token operator">:</span><span class="token space"> </span><span class="token string">'Insert<span class="token space"> </span>Shortcode'</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>cmd<span class="token operator">:</span><span class="token space"> </span><span class="token string">'plugin_command'</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token comment">//<span class="token space"> </span>Called<span class="token space"> </span>when<span class="token space"> </span>we<span class="token space"> </span>click<span class="token space"> </span>the<span class="token space"> </span>Insert<span class="token space"> </span>Gistpen<span class="token space"> </span>button</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>editor<span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token string">'plugin_command'</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token comment">//<span class="token space"> </span>Calls<span class="token space"> </span>the<span class="token space"> </span>pop-up<span class="token space"> </span>modal</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>editor<span class="token punctuation">.</span>windowManager<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token comment">//<span class="token space"> </span>Modal<span class="token space"> </span>settings</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>title<span class="token operator">:</span><span class="token space"> </span><span class="token string">'Insert<span class="token space"> </span>Shortcode'</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>width<span class="token operator">:</span><span class="token space"> </span><span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token space"> </span>window<span class="token space"> </span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">width</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token operator">*</span><span class="token space"> </span><span class="token number">0.7</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token comment">//<span class="token space"> </span>minus<span class="token space"> </span>head<span class="token space"> </span>and<span class="token space"> </span>foot<span class="token space"> </span>of<span class="token space"> </span>dialog<span class="token space"> </span>box</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>height<span class="token operator">:</span><span class="token space"> </span><span class="token punctuation">(</span><span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token space"> </span>window<span class="token space"> </span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">height</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token operator">-</span><span class="token space"> </span><span class="token number">36</span><span class="token space"> </span><span class="token operator">-</span><span class="token space"> </span><span class="token number">50</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token operator">*</span><span class="token space"> </span><span class="token number">0.7</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>inline<span class="token operator">:</span><span class="token space"> </span><span class="token number">1</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>id<span class="token operator">:</span><span class="token space"> </span><span class="token string">'plugin-slug-insert-dialog'</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>buttons<span class="token operator">:</span><span class="token space"> </span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>text<span class="token operator">:</span><span class="token space"> </span><span class="token string">'Insert'</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>id<span class="token operator">:</span><span class="token space"> </span><span class="token string">'plugin-slug-button-insert'</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token keyword">class</span><span class="token operator">:</span><span class="token space"> </span><span class="token string">'insert'</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token function-variable function">onclick</span><span class="token operator">:</span><span class="token space"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token parameter">e</span><span class="token space"> </span><span class="token punctuation">)</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token function">insertShortcode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>text<span class="token operator">:</span><span class="token space"> </span><span class="token string">'Cancel'</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>id<span class="token operator">:</span><span class="token space"> </span><span class="token string">'plugin-slug-button-cancel'</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>onclick<span class="token operator">:</span><span class="token space"> </span><span class="token string">'close'</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token function">appendInsertDialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token punctuation">}</span><span class="token lf">
</span><span class="token lf">
</span><span class="token tab">	</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token lf">
</span><span class="token tab">	</span>tinymce<span class="token punctuation">.</span>PluginManager<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token string">'plugin_slug'</span><span class="token punctuation">,</span><span class="token space"> </span>tinymce<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span>plugin_slug<span class="token space"> </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token lf">
</span><span class="token tab">	</span><span class="token keyword">function</span><span class="token space"> </span><span class="token function">appendInsertDialog</span><span class="token space"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token keyword">var</span><span class="token space"> </span>dialogBody<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span><span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token string">'#plugin-slug-insert-dialog-body'</span><span class="token space"> </span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token string">'[Loading<span class="token space"> </span>element<span class="token space"> </span>like<span class="token space"> </span>span.spinner]'</span><span class="token space"> </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token comment">//<span class="token space"> </span>Get<span class="token space"> </span>the<span class="token space"> </span>form<span class="token space"> </span>template<span class="token space"> </span>from<span class="token space"> </span>WordPress</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span>jQuery<span class="token punctuation">.</span><span class="token function">post</span><span class="token punctuation">(</span><span class="token space"> </span>ajaxurl<span class="token punctuation">,</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>action<span class="token operator">:</span><span class="token space"> </span><span class="token string">'plugin_slug_insert_dialog'</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token parameter">response</span><span class="token space"> </span><span class="token punctuation">)</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>template<span class="token space"> </span><span class="token operator">=</span><span class="token space"> </span>response<span class="token punctuation">;</span><span class="token lf">
</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>dialogBody<span class="token punctuation">.</span><span class="token function">children</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token string">'.loading'</span><span class="token space"> </span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span>dialogBody<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token space"> </span>template<span class="token space"> </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token tab">	</span><span class="token function">jQuery</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token string">'.spinner'</span><span class="token space"> </span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token tab">	</span><span class="token tab">	</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token tab">	</span><span class="token punctuation">}</span><span class="token lf">
</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button type="button">Copy</button></div><div class="toolbar-item"><span>tinyce-plugin.php</span></div></div></div></div></div>
<p class="font-ovo text-xl leading-normal pb-3">First, we create the plugin on <a class="no-underline border-b-2 border-darkg" href="/add-button-pop-wordpresss-tinymce-editor/#gistpen-tinymce-button-plugin.4">line 4</a>. Don’t forget to swap out your plugin slug.</p>
<p class="font-ovo text-xl leading-normal pb-3">On <a class="no-underline border-b-2 border-darkg" href="/add-button-pop-wordpresss-tinymce-editor/#gistpen-tinymce-button-plugin.9-14">lines 9-14</a>, we add the button to TinyMCE. You can edit the button text, but it doesn’t look great, or you can define its icon class and display an icon there. <code class="whitespace-nowrap">cmd</code> defines what command is run when you click the button.</p>
<p class="font-ovo text-xl leading-normal pb-3">Next, we <a class="no-underline border-b-2 border-darkg" href="/add-button-pop-wordpresss-tinymce-editor/#gistpen-tinymce-button-plugin.17">register the command</a> and open the pop-up using TinyMCE’s windowManager API.</p>
<p class="font-ovo text-xl leading-normal pb-3">We can define some aspects of the pop-up using their API. Some of these, like the buttons property and the id property, aren’t well documented, but you can see some of the properties <a class="no-underline border-b-2 border-darkg" href="http://www.tinymce.com/wiki.php/API3:method.tinymce.WindowManager.open">here</a><sup><a class="no-underline border-b-2 border-darkg" href="/add-button-pop-wordpresss-tinymce-editor/#fn:1">1</a></sup>.</p>
<p class="font-ovo text-xl leading-normal pb-3">TinyMCE has its own window API, and a number of tutorials will show you how to use it to build your own forms, which you can find and use, but I wanted more flexibility for my form. In a future version of the app, I plan to draw the form with jQuery, as it’ll be faster than requesting it via Ajax, but this was certainly easier. Here’s how this works.</p>
<p class="font-ovo text-xl leading-normal pb-3">After the pop-up is opened and ready to go, we <a class="no-underline border-b-2 border-darkg" href="/add-button-pop-wordpresss-tinymce-editor/#gistpen-tinymce-button-plugin.42">call a function</a>. That function makes an <a class="no-underline border-b-2 border-darkg" href="/add-button-pop-wordpresss-tinymce-editor/#gistpen-tinymce-button-plugin.56-64">Ajax call</a> that the form and appends the response to the body of the dialog box.</p>
<p class="font-ovo text-xl leading-normal pb-3">On the WordPress side of the Ajax call, we just have to register a function to that returns the form.</p>
<div data-brk-container="repo"><div class="mb-5"><div class="code-toolbar"><pre class="line-numbers language-php" data-filename="register-ajax.php"><code class="language-php"><span class="token function">add_action</span><span class="token punctuation">(</span><span class="token space"> </span><span class="token string single-quoted-string">'wp_ajax_plugin_slug_insert_dialog'</span><span class="token punctuation">,</span><span class="token space"> </span><span class="token string single-quoted-string">'plugin_slug_insert_gistpen_dialog'</span><span class="token space"> </span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token lf">
</span><span class="token keyword">function</span><span class="token space"> </span><span class="token function">plugin_slug_insert_gistpen_dialog</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token space"> </span><span class="token punctuation">{</span><span class="token lf">
</span><span class="token lf">
</span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token space"> </span><span class="token keyword">die</span><span class="token punctuation">(</span><span class="token keyword">include</span><span class="token space"> </span><span class="token string single-quoted-string">'path/to/dialog/form.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token lf">
</span><span class="token lf">
</span><span class="token punctuation">}</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><div class="toolbar"><div class="toolbar-item"><button type="button">Copy</button></div><div class="toolbar-item"><span>register-ajax.php</span></div></div></div></div></div>
<p class="font-ovo text-xl leading-normal pb-3">You can then create and return a form in standard PHP!</p>
<p class="font-ovo text-xl leading-normal pb-3">Using some of these techniques, I actually added a search box into my form, and made it possible to create a new Gistpen from the pop-up. If you want to see how that was accomplished, check out the <a class="no-underline border-b-2 border-darkg" href="https://github.com/mAAdhaTTah/WP-Gistpen">WP-Gistpen project on GitHub</a>.</p>
<div class="footnotes">
<hr>
<ol class="list-decimal pl-4 mb-5">
<li class="mb-1 font-ovo text-xl">
<p class="font-ovo text-xl leading-normal pb-3">I’m actually writing this tutorial because of how frustratingly bad the documentation is. For a brief period, I was actually swapping out the button text and giving it a class in jQuery because I didn’t realize you could edit it yourself. Read the source next time, I guess.&nbsp;<a class="no-underline border-b-2 border-darkg" href="/add-button-pop-wordpresss-tinymce-editor/#fnref:1">↩</a></p>
</li>
</ol>
</div>
</section></article></div></div></div></div>